<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ö–∞–π—Ä–Ω–∞–∫—Å ‚Äî —Ä–∞—Å—Å–∫–∞–∑—ã</title>
  <meta name="description" content="–ö–æ—Ä–æ—Ç–∫–∞—è –ù–§ –±–µ–∑ –ª–æ—Ä–æ–≤–æ–≥–æ –±–∞—Ä—å–µ—Ä–∞. –í–µ—Ç–∫–∏, —Ç–µ–≥–∏, –∑–∞–º–µ—Ç–∫–∏, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏." />
  <meta name="theme-color" content="#0b0f14" />
  <style>
    /* ======= THEME TOKENS ======= */
    :root{
      --bg:#0b0f14; --fg:#e6e6e6; --muted:#9aa5b1;
      --card:#0f1520; --line:#1f2a3a; --accent:#7dd3fc; --accent2:#a78bfa;
      --link:#93c5fd; --max:960px; --r:14px; --shadow:0 8px 24px rgba(0,0,0,.35);
      --code:#0a0e16;
    }
    [data-theme="light"]{
      --bg:#ffffff; --fg:#0b0f14; --muted:#5a6774;
      --card:#ffffff; --line:#e4e8ef; --accent:#0ea5e9; --accent2:#7c3aed;
      --link:#1d4ed8; --shadow:0 2px 12px rgba(0,0,0,.07);
      --code:#f6f8fb;
    }
    /* CRINGE MODE ‚Äî —è—Ä–∫–æ, —Å–º–µ—à–Ω–æ, –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –ø–µ—Ä–µ–±–æ—Ä */
    [data-theme="cringe"]{
      --bg:linear-gradient(135deg,#ffb6f3,#ffd699 60%,#b3f1ff);
      --fg:#222; --muted:#444; --card:rgba(255,255,255,.85); --line:#ffd1f4;
      --accent:#ff3ea5; --accent2:#ff7a00; --link:#7c00ff; --shadow:0 8px 30px rgba(0,0,0,.25);
      --code:#fff5ff;
    }

    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--fg);
      font:16px/1.7 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Inter,Arial,"Comic Sans MS",sans-serif;
    }

    /* ======= STARFIELD + FIGURES ======= */
    body::before, body::after{
      content:""; position:fixed; inset:0; pointer-events:none; z-index:-1;
      background:
        radial-gradient(1px 1px at 20px 30px, rgba(255,255,255,.8), transparent 2px),
        radial-gradient(1px 1px at 130px 80px, rgba(255,255,255,.7), transparent 2px),
        radial-gradient(1px 1px at 260px 160px, rgba(255,255,255,.6), transparent 2px),
        radial-gradient(1px 1px at 420px 40px, rgba(255,255,255,.8), transparent 2px);
      background-size: 500px 300px, 400px 400px, 600px 500px, 700px 350px;
      animation: twinkle 12s linear infinite alternate;
      opacity:.5;
    }
    body::after{
      filter: blur(0.5px) brightness(0.9);
      animation-duration: 16s;
    }
    @keyframes twinkle { from{opacity:.35; transform:translateY(0)} to{opacity:.75; transform:translateY(-6px)} }
    .shapes{
      position:fixed; right:10px; top:70px; width:200px; height:180px; pointer-events:none; z-index:0; opacity:.4;
    }
    .shape{position:absolute; border:1px solid var(--accent); border-radius:10px; transform:rotate(12deg); }
    .shape.s1{left:10px; top:20px; width:38px; height:38px; animation:float 9s ease-in-out infinite;}
    .shape.s2{right:6px; top:0; width:24px; height:60px; transform:rotate(-12deg); animation:float 13s ease-in-out infinite;}
    .shape.s3{left:70px; bottom:10px; width:64px; height:28px; border-radius:999px; animation:float 11s ease-in-out infinite;}
    @keyframes float { 0%{transform:translateY(0) rotate(0)} 50%{transform:translateY(-6px) rotate(2deg)} 100%{transform:translateY(0) rotate(0)} }

    /* ======= LAYOUT ======= */
    header{
      position:sticky; top:0; z-index:5;
      background:linear-gradient(to bottom, rgba(15,21,32,.92), rgba(15,21,32,.6));
      backdrop-filter: blur(8px) saturate(1.1);
      border-bottom:1px solid var(--line);
    }
    [data-theme="light"] header{background:linear-gradient(to bottom, rgba(255,255,255,.9), rgba(255,255,255,.7))}
    [data-theme="cringe"] header{background:linear-gradient(90deg, rgba(255,255,255,.8), rgba(255,255,255,.6))}
    .head{max-width:var(--max); margin:0 auto; padding:12px 16px; display:flex; gap:10px; align-items:center}
    .brand{font-weight:800; letter-spacing:.2px}
    .brand a{color:var(--fg); text-decoration:none}
    .search{flex:1; display:flex; gap:8px; align-items:center}
    .search input{flex:1; padding:10px 12px; border-radius:10px; border:1px solid var(--line); background:var(--card); color:var(--fg)}
    .btn,button{border:1px solid var(--line); background:var(--card); color:var(--fg); padding:8px 12px; border-radius:10px; cursor:pointer; text-decoration:none; box-shadow:var(--shadow)}
    [data-theme="cringe"] .btn,[data-theme="cringe"] button{border-color:#ff9de0}
    main{max-width:var(--max); margin:0 auto; padding:20px 16px 72px; position:relative; z-index:1}
    .grid{display:grid; grid-template-columns:1fr; gap:16px}
    @media (min-width:900px){ .grid{grid-template-columns:1.15fr .85fr; gap:22px} }
    .card{background:var(--card); border-radius:var(--r); padding:18px; box-shadow:var(--shadow); border:1px solid var(--line)}
    h1{margin:6px 0 10px; font-size:28px} h2{margin:6px 0 8px} h3{margin:6px 0 8px}
    .muted{color:var(--muted)}
    .list{display:flex; flex-direction:column; gap:12px}
    .story-item{padding:14px; border-radius:12px; background:linear-gradient(180deg, rgba(125,211,252,.08), transparent); border:1px solid rgba(125,211,252,.18)}
    .story-item a{color:var(--fg); text-decoration:none}
    .title{font-weight:700}
    a{color:var(--link)}
    article{max-width:var(--max); margin:0 auto}
    .prose{font-family: Georgia, "Times New Roman", serif; font-size:18px; line-height:1.75}
    .prose p{margin:0 0 14px}
    .tag{display:inline-block; padding:2px 8px; border-radius:999px; border:1px solid var(--line); color:var(--muted); font-size:12px; margin-right:6px}
    .back{display:inline-flex; align-items:center; gap:8px; margin:6px 0 12px}
    .footer{opacity:.8; font-size:14px; margin-top:18px}
    .progress{position:fixed; left:0; top:0; height:3px; background:linear-gradient(90deg, var(--accent), var(--accent2)); width:0; z-index:6}

    .arc-cards{display:grid; grid-template-columns:1fr; gap:12px}
    @media (min-width:700px){ .arc-cards{grid-template-columns:repeat(2,1fr)} }

    pre{background:var(--code); padding:10px; border-radius:10px; overflow:auto}
  </style>
</head>
<body>
  <div class="progress" id="progress"></div>
  <header>
    <div class="head">
      <div class="brand"><a href="#/">–ö–∞–π—Ä–Ω–∞–∫—Å</a></div>
      <div class="search" style="max-width:600px">
        <input id="q" type="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Ä–∞—Å—Å–∫–∞–∑–∞–º‚Ä¶" aria-label="–ü–æ–∏—Å–∫" />
        <a class="btn" href="#/arcs">–í–µ—Ç–∫–∏</a>
        <a class="btn" href="#/notes">–ó–∞–º–µ—Ç–∫–∏</a>
        <a class="btn" href="#/about">–û –º–∏—Ä–µ</a>
        <button id="themeBtn" title="–¢–µ–º–∞">üåì</button>
      </div>
    </div>
  </header>
  <div class="shapes"><div class="shape s1"></div><div class="shape s2"></div><div class="shape s3"></div></div>
  <main id="app" aria-live="polite"></main>

  <!-- COMMENTS INJECTOR (utterances) -->
  <script>
    // ======= DATA =======
    const state={
      theme: localStorage.getItem('theme') || 'dark',
      route: location.hash.slice(1)||'/',
      q:''
    };

    const arcs=[
      { id:'dominus', title:'DOMINUS / –ò–æ–Ω–∞', desc:'–ú–∞—à–∏–Ω–∞, –∏—Å–ø–æ–≤–µ–¥—å –∏ ¬´–ü—É—Å—Ç–æ–π –í—ã–±–æ—Ä¬ª.', order:['epitimya'] },
      { id:'lines',   title:'–õ–∏–Ω–∏–∏ / –ê—Å—Å–∏',   desc:'–ö—É—Ä—å–µ—Ä—ã, —Å–µ–∫—Ç–æ—Ä–∞ –∏ –≤—ã–∂–∏–≤–∞–Ω–∏–µ.', order:['dorogovato'] },
      { id:'infra',   title:'–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞', desc:'–ò–Ω–∂–µ–Ω–µ—Ä–∏—è, –ª—é–¥–∏ –∏ —Ç–µ–º–ø–æ—Ä–∞–ª—å–Ω—ã–µ —à–≤—ã.', order:['chelovecheskiy-faktor'] },
      { id:'ibut',    title:'–ò–ë–£–¢',           desc:'–õ—ë–≥–∫–æ–µ —á—Ç–∏–≤–æ –ø—Ä–æ –º–∏—Ä –ø–æ–ø–∞–¥–∞–Ω—Ü–µ–≤.', order:['ibut-g1','ibut-g2'] }
    ];

    const stories=[
      {
        id:'epitimya',
        title:'–ï–ø–∏—Ç–∏–º—å—è',
        date:'2025-08-01', minutes:12,
        tags:['–ö–∞–π—Ä–Ω–∞–∫—Å','DOMINUS','—ç—Ç–∏–∫–∞'],
        arc:'dominus',
        text:`–ó–ê–ì–õ–£–®–ö–ê: –í–°–¢–ê–í–ò–¢–¨ –¢–ï–ö–°–¢ (–ï–ø–∏—Ç–∏–º—å—è)`
      },
      {
        id:'dorogovato',
        title:'–î–æ—Ä–æ–≥–æ–≤–∞—Ç–æ',
        date:'2025-07-25', minutes:10,
        tags:['–ö–∞–π—Ä–Ω–∞–∫—Å','–ª–∏–Ω–∏–∏','R-—Å–µ–∫—Ç–æ—Ä'],
        arc:'lines',
        text:`–ó–ê–ì–õ–£–®–ö–ê: –í–°–¢–ê–í–ò–¢–¨ –¢–ï–ö–°–¢ (–î–æ—Ä–æ–≥–æ–≤–∞—Ç–æ)`
      },
      {
        id:'chelovecheskiy-faktor',
        title:'–ß–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π —Ñ–∞–∫—Ç–æ—Ä',
        date:'2025-07-23', minutes:9,
        tags:['–ö–∞–π—Ä–Ω–∞–∫—Å','–∏–Ω–∂–µ–Ω–µ—Ä–∏—è'],
        arc:'infra',
        text:`–ó–ê–ì–õ–£–®–ö–ê: –í–°–¢–ê–í–ò–¢–¨ –¢–ï–ö–°–¢ (–ß–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π —Ñ–∞–∫—Ç–æ—Ä)`
      },
      {
        id:'ibut-g1',
        title:'–ò–ë–£–¢ ‚Äî –≥–ª–∞–≤–∞ 1',
        date:'2025-08-08', minutes:8,
        tags:['–ò–ë–£–¢','–ø–æ–ø–∞–¥–∞–Ω—Ü—ã'],
        arc:'ibut',
        text:`–ó–ê–ì–õ–£–®–ö–ê: –í–°–¢–ê–í–ò–¢–¨ –¢–ï–ö–°–¢ (–ò–ë–£–¢ ‚Äî –≥–ª–∞–≤–∞ 1)`
      },
      {
        id:'ibut-g2',
        title:'–ò–ë–£–¢ ‚Äî –≥–ª–∞–≤–∞ 2',
        date:'2025-08-08', minutes:8,
        tags:['–ò–ë–£–¢','–ø–æ–ø–∞–¥–∞–Ω—Ü—ã'],
        arc:'ibut',
        text:`–ó–ê–ì–õ–£–®–ö–ê: –í–°–¢–ê–í–ò–¢–¨ –¢–ï–ö–°–¢ (–ò–ë–£–¢ ‚Äî –≥–ª–∞–≤–∞ 2)`
      }
    ];

    const notes=[
      { id:'n-2025-08-08-a', title:'–û —Ç–æ–Ω–µ –∏ —Ç–µ–º–ø–µ ¬´–ö–∞–π—Ä–Ω–∞–∫—Å–∞¬ª', date:'2025-08-08',
        text:`–ó–ê–ì–õ–£–®–ö–ê: –í–°–¢–ê–í–ò–¢–¨ –¢–ï–ö–°–¢ (–∑–∞–º–µ—Ç–∫–∞ –æ —Ç–æ–Ω–µ).` },
      { id:'n-2025-08-08-b', title:'–ß–µ—Ä–Ω–æ–≤—ã–µ –∏–¥–µ–∏ –∞—Ä–æ–∫', date:'2025-08-08',
        text:`–ó–ê–ì–õ–£–®–ö–ê: –í–°–¢–ê–í–ò–¢–¨ –¢–ï–ö–°–¢ (–∏–¥–µ–∏ –∞—Ä–æ–∫).` }
    ];

    // ======= THEME =======
    const applyTheme=()=>{
      document.documentElement.setAttribute('data-theme',state.theme);
      localStorage.setItem('theme',state.theme);
      setUtterancesTheme(state.theme);
    };
    applyTheme();
    document.getElementById('themeBtn').onclick=()=>{
      state.theme = state.theme==='dark' ? 'light' : (state.theme==='light' ? 'cringe' : 'dark');
      applyTheme();
    };

    // ======= ROUTER =======
    addEventListener('hashchange',()=>{ state.route=location.hash.slice(1)||'/'; render(); restoreScroll(); });

    const app=document.getElementById('app');
    const qEl=document.getElementById('q'); qEl.addEventListener('input',()=>{ state.q=qEl.value.trim().toLowerCase(); renderList(); });

    function fmtDate(iso){ try{const d=new Date(iso); return d.toLocaleDateString('ru-RU',{year:'numeric',month:'long',day:'numeric'});}catch(_){return iso} }

    // ======= LIST =======
    function renderList(){
      const q=state.q;
      const items=stories.filter(s=>!q || s.title.toLowerCase().includes(q) || s.text.toLowerCase().includes(q) || (s.tags||[]).join(' ').toLowerCase().includes(q));
      app.innerHTML = `
        <div class="grid">
          <section class="card">
            <h1>–†–∞—Å—Å–∫–∞–∑—ã</h1>
            <div class="muted">–ö–æ—Ä–æ—Ç–∫–∞—è –ù–§ –±–µ–∑ –ª–æ—Ä–æ–≤–æ–≥–æ –±–∞—Ä—å–µ—Ä–∞. –í—ã–±–∏—Ä–∞–π –∏ —á–∏—Ç–∞–π.</div>
            <div class="list">
              ${items.map(s=>{
                const ex = s.text.replace(/\n+/g,' ').slice(0,130).trim()+(s.text.length>130?'‚Ä¶':'');
                return `<div class="story-item">
                  <a href="#/read/${s.id}">
                    <div class="title">${s.title}</div>
                    <div class="muted">${fmtDate(s.date)} ¬∑ ${s.minutes} –º–∏–Ω —á—Ç–µ–Ω–∏—è ¬∑ –≤–µ—Ç–∫–∞: ${arcById(s.arc).title}</div>
                    <div>${ex}</div>
                  </a>
                </div>`;
              }).join('')}
            </div>
          </section>
          <aside class="card">
            <h2>–í–µ—Ç–∫–∏</h2>
            <div class="arc-cards">
              ${arcs.map(a=>`
                <div class="story-item">
                  <a href="#/arc/${a.id}">
                    <div class="title">${a.title}</div>
                    <div class="muted">${a.order.length} —Ç–µ–∫—Å—Ç(–∞)</div>
                    <div>${a.desc}</div>
                  </a>
                </div>`).join('')}
            </div>
            <h3 style="margin-top:14px">–ü–æ–¥–ø–∏—Å–∫–∞</h3>
            <p class="muted">–¢–µ–ª–µ–≥—Ä–∞–º: <a href="https://t.me/kainrax" target="_blank" rel="noopener">@kainrax</a></p>
            <p><span class="tag">–∂–∞–Ω—Ä: –ù–§</span> <span class="tag">–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: –ø–Ω/—á—Ç</span></p>
          </aside>
        </div>`;
    }

    // ======= ARCS & TAGS =======
    const arcById = id => arcs.find(a=>a.id===id) || {title:'–í–µ—Ç–∫–∞', order:[]};

    function renderArc(id){
      const a=arcById(id); if(!a) { location.hash='#/arcs'; return; }
      const arr=a.order.map(id=>stories.find(s=>s.id===id)).filter(Boolean);
      app.innerHTML = `
        <section class="card">
          <a class="back" href="#/arcs">‚Üê –ö–æ –≤—Å–µ–º –≤–µ—Ç–∫–∞–º</a>
          <h1>${a.title}</h1>
          <div class="muted">${a.desc}</div>
          <ol class="list" style="margin-top:10px">
            ${arr.map((s,i)=>`
              <li class="story-item">
                <a href="#/read/${s.id}">
                  <div class="title">${i+1}. ${s.title}</div>
                  <div class="muted">${fmtDate(s.date)} ¬∑ ${s.minutes} –º–∏–Ω</div>
                </a>
              </li>`).join('')}
          </ol>
        </section>`;
    }

    function renderArcs(){
      app.innerHTML = `
        <section class="card">
          <h1>–í–µ—Ç–∫–∏</h1>
          <div class="arc-cards">${arcs.map(a=>`
            <div class="story-item">
              <a href="#/arc/${a.id}">
                <div class="title">${a.title}</div>
                <div class="muted">${a.order.length} —Ç–µ–∫—Å—Ç(–∞)</div>
                <div>${a.desc}</div>
              </a>
            </div>`).join('')}
          </div>
        </section>`;
    }

    function renderTag(tag){
      const items=stories.filter(s=> (s.tags||[]).map(t=>t.toLowerCase()).includes(tag.toLowerCase()));
      app.innerHTML = `
        <section class="card">
          <a class="back" href="#/">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
          <h1>#${tag}</h1>
          <div class="list">${items.map(s=>`
            <div class="story-item">
              <a href="#/read/${s.id}">
                <div class="title">${s.title}</div>
                <div class="muted">${fmtDate(s.date)} ¬∑ ${s.minutes} –º–∏–Ω ¬∑ –≤–µ—Ç–∫–∞: ${arcById(s.arc).title}</div>
              </a>
            </div>`).join('')}
          </div>
        </section>`;
    }

    // ======= NOTES =======
    function renderNotes(){
      app.innerHTML = `
        <section class="card">
          <h1>–ê–≤—Ç–æ—Ä—Å–∫–∏–µ –∑–∞–º–µ—Ç–∫–∏</h1>
          <div class="list">
            ${notes.map(n=>`
              <div class="story-item">
                <a href="#/note/${n.id}">
                  <div class="title">${n.title}</div>
                  <div class="muted">${fmtDate(n.date)}</div>
                </a>
              </div>`).join('')}
          </div>
        </section>`;
    }
    function renderNote(id){
      const n=notes.find(x=>x.id===id); if(!n){location.hash='#/notes'; return;}
      app.innerHTML = `
        <a class="back" href="#/notes">‚Üê –ö –∑–∞–º–µ—Ç–∫–∞–º</a>
        <article class="prose" data-id="${n.id}">
          <h1>${n.title}</h1>
          <div class="muted">${fmtDate(n.date)}</div>
          ${n.text.split(/\n\n+/).map(p=>`<p>${p.replace(/\n/g,'<br>')}</p>`).join('')}
        </article>
        <div class="footer">–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç—Å—è –Ω–∏–∂–µ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö.</div>
        <section id="comments"></section>`;
      mountComments();
      setTimeout(restoreScroll,0);
    }

    // ======= ARTICLE =======
    const progress=document.getElementById('progress');
    let ticking=false;
    function onScroll(){
      if(ticking) return; ticking=true; requestAnimationFrame(()=>{
        const art=document.querySelector('article');
        if(!art){progress.style.width='0%'; ticking=false; return;}
        const total=art.scrollHeight - window.innerHeight + 1;
        const pct=Math.min(100, Math.max(0, ((window.scrollY - art.offsetTop) / total)*100));
        progress.style.width=(isFinite(pct)?pct:0)+'%';
        const id=art.dataset.id; if(id){ localStorage.setItem('read:'+id, window.scrollY); }
        ticking=false;
      });
    }
    addEventListener('scroll', onScroll, {passive:true});

    function restoreScroll(){
      const art=document.querySelector('article'); if(!art) return;
      const y=+localStorage.getItem('read:'+art.dataset.id)||0; if(y>0) setTimeout(()=>scrollTo({top:y,behavior:'instant'}),0);
    }

    function renderArticle(id){
      const s=stories.find(x=>x.id===id); if(!s){ location.hash='#/'; return; }
      const a=arcById(s.arc);
      const idx=a.order.indexOf(s.id);
      const prevId= idx>0 ? a.order[idx-1] : null;
      const nextId= idx<a.order.length-1 ? a.order[idx+1] : null;

      app.innerHTML = `
        <a class="back" href="#/">‚Üê –ö —Å–ø–∏—Å–∫—É</a>
        <article class="prose" data-id="${s.id}">
          <h1>${s.title}</h1>
          <div class="muted">${fmtDate(s.date)} ¬∑ ${s.minutes} –º–∏–Ω —á—Ç–µ–Ω–∏—è ¬∑ –≤–µ—Ç–∫–∞: <a href="#/arc/${a.id}">${a.title}</a> (${idx+1}/${a.order.length})</div>
          <div style="margin:6px 0 12px">${(s.tags||[]).map(t=>`<a class='tag' href='#/tag/${encodeURIComponent(t)}'>${t}</a>`).join(' ')}</div>
          ${s.text.split(/\n\n+/).map(p=>`<p>${p.replace(/\n/g,'<br>')}</p>`).join('')}
          <hr style="border:0;border-top:1px solid var(--line);margin:18px 0">
          <div style="display:flex;justify-content:space-between;gap:10px">
            ${prevId?`<a class="btn" href="#/read/${prevId}">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>`:'<span></span>'}
            ${nextId?`<a class="btn" href="#/read/${nextId}">–°–ª–µ–¥—É—é—â–∞—è ‚Üí</a>`:'<span></span>'}
          </div>
        </article>

        <section class="card" style="margin-top:16px">
          <h3>–ü–æ—Ö–æ–∂–∏–µ</h3>
          <div class="list">
            ${stories.filter(x=>x.id!==s.id && x.tags?.some(t=>s.tags?.includes(t))).slice(0,3).map(p=>`
              <div class="story-item"><a href="#/read/${p.id}">
                <div class="title">${p.title}</div>
                <div class="muted">${fmtDate(p.date)} ¬∑ ${p.minutes} –º–∏–Ω</div>
              </a></div>`).join('') || '<div class="muted">–ü–æ–∫–∞ –ø—É—Å—Ç–æ.</div>'}
          </div>
        </section>

        <section id="comments" class="card" style="margin-top:16px"></section>
      `;
      mountComments();
      setTimeout(restoreScroll,0);
    }

    // ======= ABOUT =======
    function renderAbout(){
      app.innerHTML = `
        <section class="card">
          <h1>–û –º–∏—Ä–µ ¬´–ö–∞–π—Ä–Ω–∞–∫—Å¬ª</h1>
          <div class="prose">
            <p><strong>–ö–∞–π—Ä–Ω–∞–∫—Å</strong> ‚Äî –ø–æ–¥–∑–µ–º–Ω–∞—è —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ —Å ¬´–ª–∏–Ω–∏—è–º–∏¬ª ‚Äî –∑–æ–Ω–∞–º–∏, –≥–¥–µ –∏—Å–∫–∞–∂–∞—é—Ç—Å—è –≤—Ä–µ–º—è, –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏ –ø—Å–∏—Ö–∏–∫–∞. –õ—é–¥–∏ –∂–∏–≤—É—Ç —Å–µ–∫—Ç–æ—Ä–∞–º–∏ A/B/C/R –∏ –¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –Ω–∞ —É–ø—Ä—è–º—Å—Ç–≤–µ –∏ —Ä–µ–º—ë—Å–ª–∞—Ö.</p>
            <p>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∞–π—Ç–∞: <em>–†–∞—Å—Å–∫–∞–∑—ã</em>, <em>–í–µ—Ç–∫–∏</em>, <em>–¢–µ–≥–∏</em>, <em>–ó–∞–º–µ—Ç–∫–∏</em>. –í–µ—Ç–∫—É <strong>–ò–ë–£–¢</strong> —á–∏—Ç–∞–µ–º –ø–æ –ø–æ—Ä—è–¥–∫—É ‚Äî –≥–ª–∞–≤—ã 1‚Äì2 —É–∂–µ –∑–∞–≤–µ–¥–µ–Ω—ã.</p>
            <p>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ—Ç–∫—Ä—ã—Ç—ã –ø–æ–¥ –∫–∞–∂–¥—ã–º —Ç–µ–∫—Å—Ç–æ–º (GitHub Issues). –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é –∫—Ä–∏—Ç–∏–∫—É –∏ —Å—Ç—Ä–∞–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã.</p>
          </div>
        </section>`;
    }

    // ======= COMMENTS (utterances) =======
    function mountComments(){
      const wrap=document.getElementById('comments'); if(!wrap) return;
      wrap.innerHTML='';
      const s=document.createElement('script');
      s.src='https://utteranc.es/client.js';
      s.setAttribute('repo','sviam-byte/kainrax-site');      // <= —Ç–≤–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
      s.setAttribute('issue-term','pathname');               // —Å–≤—è–∑—ã–≤–∞–µ–º –æ–±—Å—É–∂–¥–µ–Ω–∏–µ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π
      s.setAttribute('theme', state.theme==='light' ? 'github-light' : 'github-dark');
      s.setAttribute('crossorigin','anonymous');
      s.async=true;
      wrap.appendChild(s);
    }
    function setUtterancesTheme(theme){
      const iframe=document.querySelector('iframe.utterances-frame');
      if(!iframe) return;
      iframe.contentWindow.postMessage({type:'set-theme', theme: theme==='light'?'github-light':'github-dark'}, 'https://utteranc.es');
    }

    // ======= RENDERER =======
    function render(){
      const r=state.route;
      if(r==='/'||r===''){ renderList(); return; }
      if(r==='/about'){ renderAbout(); return; }
      if(r==='/arcs'){ renderArcs(); return; }
      const mRead=r.match(/^\/read\/(.+)$/); if(mRead){ renderArticle(mRead[1]); return; }
      const mArc=r.match(/^\/arc\/(.+)$/); if(mArc){ renderArc(mArc[1]); return; }
      const mTag=r.match(/^\/tag\/(.+)$/); if(mTag){ renderTag(decodeURIComponent(mTag[1])); return; }
      const mNote=r.match(/^\/note\/(.+)$/); if(mNote){ renderNote(mNote[1]); return; }
      if(r==='/notes'){ renderNotes(); return; }
      renderList();
    }
    render();
  </script>
</body>
</html>
