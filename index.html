<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Кайнракс — наш дом</title>
  <meta name="description" content="Детская энциклопедия Кайнракс: наш дом, построенный разумом, Воздвиженцы, сигиллы и безопасность.">
  <meta name="theme-color" content="#0b0f14" />
  <meta name="color-scheme" content="dark">
  <style>
    /* ====== Базовые переменные ====== */
    :root{
      --bg:#0c1220; --panel:#0f1730; --ink:#e8f0ff; --muted:#c4cdea;
      --accent:#7de0ff; --accent2:#a3ffcf; --brand:#ffd86b; --card:#121a33;
      --border:rgba(255,255,255,.10); --shadow:0 8px 30px rgba(0,0,0,.35);
      --radius:20px; --wrap:1200px; --gap:24px; --tap:44px;
    }
    html{color-scheme:dark; scroll-padding-top:84px}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Inter,Arial,sans-serif; line-height:1.6}
    a{color:var(--accent);text-decoration:none}
    b,strong{font-weight:600}
    .wrap{max-width:var(--wrap); margin:0 auto; padding:24px}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
    .skip{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
    .skip:focus{left:16px;top:8px;width:auto;height:auto;background:#111a33;color:#fff;padding:8px 12px;border-radius:8px;z-index:1000}

    /* ====== Навбар ====== */
    nav.top{position:sticky;top:0;background:rgba(12,18,32,.86);backdrop-filter:blur(8px);
      border-bottom:1px solid var(--border); z-index:50}
    nav.top .wrap{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{font-weight:700;letter-spacing:.3px;color:var(--brand)}
    .menu{display:flex;flex-wrap:wrap;gap:4px}
    .menu a{padding:12px 12px;min-height:var(--tap);display:flex;align-items:center;border-radius:10px;color:var(--ink);opacity:.95;font-size:14px}
    .menu a:hover,.menu a:focus-visible{background:rgba(255,255,255,.06);outline:none}
    .nav-toggle{display:none;background:transparent;border:1px solid var(--border);color:var(--ink);
      border-radius:10px;padding:8px;cursor:pointer}
    .nav-toggle:focus-visible{outline:2px solid var(--accent);outline-offset:2px}

    /* ====== Hero ====== */
    header.hero{position:relative;isolation:isolate;overflow:hidden;min-height:68vh;
      display:grid;place-items:center;background:linear-gradient(180deg,#0a1123,#0c1220)}
    header.hero img.bg{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;opacity:.25;filter:contrast(110%) saturate(110%);z-index:-1}
    .title{text-align:center;background:rgba(16,24,48,.55);border:1px solid var(--border);
      padding:24px 28px;border-radius:var(--radius);box-shadow:var(--shadow)}
    .title h1{margin:0 0 6px;font-size:clamp(28px,5vw,48px)}
    .title p{margin:0;color:var(--muted)}
    .kicker{color:var(--muted);font-size:14px;text-transform:uppercase;letter-spacing:.2em}

    /* ====== Layout ====== */
    section{scroll-margin-top:84px; padding:48px 0; content-visibility:auto; contain-intrinsic-size:1px 1000px}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:var(--gap);align-items:start}
    .col-12{grid-column:span 12} .col-8{grid-column:span 8} .col-7{grid-column:span 7}
    .col-6{grid-column:span 6} .col-5{grid-column:span 5} .col-4{grid-column:span 4}
    @media (max-width:980px){.grid{grid-template-columns:repeat(6,1fr)} .col-8,.col-7,.col-6,.col-5{grid-column:span 6}}
    @media (max-width:720px){
      .grid{grid-template-columns:repeat(4,1fr); gap:16px}
      .col-8,.col-7,.col-6,.col-5,.col-4{grid-column:span 4}
      header.hero{min-height:60vh}
      .title{backdrop-filter:none;box-shadow:none}
      .wrap{padding:20px}
      .nav-toggle{display:block}
      .menu{position:fixed; inset:56px 0 0 0; display:none; flex-direction:column; gap:4px; padding:12px 16px;
        background:rgba(12,18,32,.98); backdrop-filter:blur(4px)}
      .menu.open{display:flex}
      body.no-scroll{overflow:hidden}
    }

    /* ====== Cards, Figures ====== */
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
    .card.pad{padding:24px}
    h2{font-size:clamp(22px,3.6vw,34px);margin:0 0 12px}
    h3{margin:14px 0 8px}
    .pill{display:inline-block;padding:2px 10px;border-radius:999px;font-size:12px;border:1px solid var(--border);color:var(--muted);margin-right:8px}
    .note{font-size:14px;color:var(--muted);border-left:3px solid var(--accent);padding-left:14px;margin-top:16px}
    .fact-card{background:color-mix(in oklab, var(--brand) 6%, transparent);border:1px solid color-mix(in oklab, var(--brand) 15%, transparent)}
    figure{margin:0}
    figure img{display:block;width:100%;height:auto;aspect-ratio:3/2;object-fit:cover}
    figure figcaption{font-size:14px;color:var(--muted);padding:10px 14px 16px}

    ul,ol{margin:10px 0 0; padding-left:20px}
    ul.icon-list{list-style:none;padding-left:0}
    ul.icon-list li{display:flex;align-items:flex-start;gap:12px;margin-bottom:8px}
    ul.icon-list .icon{flex-shrink:0;width:20px;height:20px;margin-top:2px;color:var(--accent)}

    /* ====== Quiz ====== */
    .quiz{display:grid;gap:16px}
    .quiz .q{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:16px}
    .quiz .options{display:flex;flex-wrap:wrap;gap:8px}
    .quiz button{background:transparent;color:var(--ink);border:1px solid rgba(255,255,255,.18);
      padding:10px 14px;min-height:var(--tap);border-radius:10px;cursor:pointer;flex-grow:1}
    .quiz button:hover,.quiz button:focus-visible{border-color:var(--accent);outline:none}
    .good{color:var(--accent2)} .bad{color:#ff8c8c} .hide{display:none}
    .quiz-summary{margin-top:16px;padding:12px 14px;border:1px solid var(--border);border-radius:12px;background:rgba(255,255,255,.04);font-size:15px}
    .quiz-summary b{color:var(--brand)}

    /* ====== Footer ====== */
    .footer{color:var(--muted);font-size:14px;text-align:center;padding:28px 0 60px}
    :focus-visible{outline:2px solid var(--accent); outline-offset:2px}
    @media (prefers-reduced-motion: reduce){
      *{animation:none!important; transition:none!important}
    }
  </style>
</head>
<body>
  <a class="skip" href="#home">Перейти к содержанию</a>

  <nav class="top" role="navigation" aria-label="Основное меню">
    <div class="wrap">
      <div class="brand">Кайнракс — наш дом</div>
      <button class="nav-toggle" aria-expanded="false" aria-controls="menu">
        <span class="sr-only">Открыть меню</span>
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M3 6h18M3 12h18M3 18h18"/></svg>
      </button>
      <div id="menu" class="menu">
        <a href="#home">Наш мир</a>
        <a href="#cities">Города</a>
        <a href="#path">Твой путь</a>
        <a href="#founders">Основатели</a>
        <a href="#hexagon">Управление</a>
        <a href="#choice">Наш выбор</a>
        <a href="#hresh">Хриш</a>
        <a href="#quiz">Викторина</a>
      </div>
    </div>
  </nav>

  <header class="hero">
    <img class="bg" src="images/skyline.png" alt="" width="1600" height="900" fetchpriority="high" decoding="async">
    <div class="wrap">
      <div class="title">
        <div class="kicker">Энциклопедия юного гражданина</div>
        <h1>Кайнракс — наш дом</h1>
        <p>Мы живём глубоко под землёй, где наш разум и труд создали безопасный мир для людей.</p>
      </div>
    </div>
  </header>

  <main class="wrap">
    <!-- ... секции (сократила для читаемости, у тебя они все есть) ... -->

    <!-- 8. Викторина -->
    <section id="quiz" aria-labelledby="quiz-h">
      <h2 id="quiz-h" class="sr-only">Викторина юного гражданина</h2>
      <div class="grid">
        <div class="col-12 card pad">
          <span class="pill">Проверка знаний</span>
          <h2>Викторина юного гражданина</h2>
          <div class="quiz" id="quizBox" aria-live="polite"></div>
          <div id="quizSummary" class="quiz-summary hide" aria-live="polite"></div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">Издано Ректоратом для будущих строителей Кайнракс. ©</footer>

  <script>
    // ====== Навигация ======
    (function(){
      const toggle = document.querySelector('.nav-toggle');
      const menu = document.getElementById('menu');
      if(!toggle || !menu) return;
      toggle.addEventListener('click', () => {
        const open = toggle.getAttribute('aria-expanded') === 'true';
        toggle.setAttribute('aria-expanded', String(!open));
        menu.classList.toggle('open', !open);
        document.body.classList.toggle('no-scroll', !open);
      });
    })();

    // ====== Викторина ======
    const data = [
      { q: "Почему наши предки Воздвиженцы ушли с Поверхности?", options: ["Они испугались темноты.", "Они отказались поклоняться богам и решили построить свой мир.", "Начался ледниковый период."], ok: 1 },
      { q: "Кто из Воздвиженцев был Первой Короной?", options: ["Лугаль", "Пишти", "Нин"], ok: 2 },
      { q: "Что такое «Пергамент»?", options: ["Древняя карта.", "Сборник наставлений, как быть сильным и умным человеком.", "Список запретов."], ok: 1 },
      { q: "Что такое «Профессиональное Направление»?", options: ["Тайный клуб.", "Путь мастерства, который ты выберешь, когда вырастешь.", "Название спортивной команды."], ok: 1 },
      { q: "Что важнее всего для того, чтобы быть гражданином Кайнракс?", options: ["Место рождения.", "Твой собственный выбор следовать нашему пути.", "Богатство семьи."], ok: 1 },
      { q: "Почему жизнь в Кайнракс стабильнее, чем на Поверхности?", options: ["У нас лучше погода.", "Потому что она основана на разуме, а не на капризах богов.", "Там нет наших городов."], ok: 1 },
      { q: "Кем является Корона в нашей системе управления?", options: ["Верховным Администратором, Первой среди равных.", "Самым богатым жителем.", "Пожизненным диктатором."], ok: 0 },
      { q: "Какой главный принцип делает нашу нацию сильной?", options: ["Слепая вера в чудеса.", "Наш разум — наша крепость.", "Надеяться на удачу."], ok: 1 }
    ];

    const box = document.getElementById('quizBox');
    const summary = document.getElementById('quizSummary');
    let answeredCount = 0, correctCount = 0;
    const total = data.length;

    function showSummary(){
      const score = Math.round((correctCount/total)*100);
      let msg = '';
      if (correctCount === total) msg = 'Идеально. Ты уже можешь читать «Пергамент» без подсказок.';
      else if (score >= 80) msg = 'Отлично! Пара правок — и ты в строю.';
      else if (score >= 60) msg = 'Хорошо. Перечитай главы про Основателей и Управление.';
      else msg = 'Есть над чем поработать. Начни с Главы 1 и 5.';
      summary.innerHTML = `<b>Итог:</b> ${correctCount} из ${total}. ${msg}`;
      summary.classList.remove('hide');
      summary.scrollIntoView({behavior:'smooth', block:'center'});
    }

    if (box){
      data.forEach((item, idx) => {
        const wrap = document.createElement('div'); 
        wrap.className = 'q';
        wrap.dataset.done = '';
        wrap.innerHTML =
          `<div class="kicker">Вопрос ${idx+1} из ${data.length}</div>
           <div style="font-size:18px; margin:6px 0 12px">${item.q}</div>
           <div class="options"></div>
           <div class="res hide" aria-live="polite"></div>`;
        const opts = wrap.querySelector('.options');
        const res = wrap.querySelector('.res');
        item.options.forEach((opt, i) => {
          const btn = document.createElement('button'); btn.type = 'button'; btn.textContent = opt;
          btn.addEventListener('click', () => {
            if (wrap.dataset.done === '1') return;
            res.classList.remove('hide');
            const correct = (i === item.ok);
            res.innerHTML = correct 
              ? '<span class="good">Верно! Твои знания — опора для Кайнракс.</span>'
              : '<span class="bad">Неверно.</span> Перечитай нужную главу.';
            opts.querySelectorAll('button').forEach(b => { if (b!==btn) b.disabled = true; });
            btn.style.borderColor = correct ? 'var(--accent2)' : '#ff8c8c';
            wrap.dataset.done = '1';
            answeredCount += 1; if (correct) correctCount += 1;
            if (answeredCount === total) showSummary();
          });
          opts.appendChild(btn);
        });
        box.appendChild(wrap);
      });
    }

    // ====== Метрика (лениво) ======
    function initYM(){
      if (window.__ymInited) return; window.__ymInited = true;
      (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,
        k.src=r,a.parentNode.insertBefore(k,a);
      })(window, document, 'script', 'https://mc.yandex.ru/metrika/tag.js?id=103716449', 'ym');
      try{
        ym(103716449,'init',{
          webvisor:true, clickmap:true, trackLinks:true, accurateTrackBounce:true, ecommerce:'dataLayer'
        });
      }catch(_){}
    }
    if (window.requestIdleCallback) requestIdleCallback(initYM);
    else setTimeout(initYM,1500);
    window.addEventListener('hashchange', () => {
      if (typeof ym==='function') ym(103716449,'hit',location.pathname+location.hash);
    });
  </script>

  <!-- Noscript-фолбэк -->
  <noscript>
    <div><img src="https://mc.yandex.ru/watch/103716449" style="position:absolute; left:-9999px;" alt=""></div>
  </noscript>
</body>
</html>
